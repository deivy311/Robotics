Robotics 2

Dynamic model of robots:
Newton-Euler approach
Prof. Alessandro De Luca

Approaches to dynamic modeling
(reprise)

Newton-Euler method
(balance of forces/torques)

energy-based approach
(Euler-Lagrange)
n
n

n

n

multi-body robot seen as a whole
constraint (internal) reaction forces
between the links are automatically
eliminated: in fact, they do not
perform work

n

n

Robotics 2

inverse dynamics in real time
n

closed-form (symbolic) equations
are directly obtained
best suited for study of dynamic
properties and analysis of control
schemes

dynamic equations written
separately for each link/body

n

n

equations are evaluated in a
numeric and recursive way
best for synthesis
(=implementation) of modelbased control schemes

by elimination of reaction forces and
back-substitution of expressions, we
still get closed-form dynamic
equations (identical to those of EulerLagrange!)
2

Derivative of a vector in a moving frame
â€¦ from velocity to acceleration

ğ‘…Ì‡ $ = ğ‘† 0ğœ”$

!

0ğ‘…

$

derivative of â€œunitâ€ vector
ğœ”ğ‘–

ğ‘‘ğ‘’$
= ğœ”$ Ã— ğ‘’$
ğ‘‘ğ‘¡

ğ‘’$

Robotics 2

3

Dynamics of a rigid body
n

Newton dynamic equation
n

balance: sum of forces = variation of linear momentum
ğ‘‘
1 ğ‘“$ =
ğ‘šğ‘£5 = ğ‘šğ‘£Ì‡5
ğ‘‘ğ‘¡

n

Euler dynamic equation
n

balance: sum of torques = variation of angular momentum
ğ‘‘
ğ‘‘
Ì… 9 ğœ” = ğ¼ ğœ”Ì‡ + ğ‘…Ì‡ ğ¼ğ‘…
Ì… 9 + ğ‘…ğ¼ğ‘…
Ì… Ì‡9 ğœ”
1 ğœ‡$ =
ğ¼ğœ” = ğ¼ ğœ”Ì‡ +
ğ‘… ğ¼ğ‘…
ğ‘‘ğ‘¡
ğ‘‘ğ‘¡
Ì… 9 ğœ” + ğ‘… ğ¼ğ‘…
Ì… 9 ğ‘† 9 ğœ” ğœ” = ğ¼ ğœ”Ì‡ + ğœ” Ã— ğ¼ğœ”
= ğ¼ ğœ”Ì‡ + ğ‘† ğœ” ğ‘… ğ¼ğ‘…

n

principle of action and reaction
n

Robotics 2

forces/torques: applied by body ğ‘– to body ğ‘– + 1
= âˆ’ applied by body ğ‘– + 1 to body ğ‘–
4

Newton-Euler equations
link ğ‘–

FORCES
center ğ’—ğ’„ğ’Š
of mass

ğ‘“$ force applied

ğ‘“$>? force applied

from link ğ‘– on link ğ‘– + 1

.

.ğ‘‚$B?
axis ğ‘–
(ğ‘$ )

from link ğ‘– âˆ’ 1 on link ğ‘–

ğ‘§$

ğ‘ªğ’Š

ğ‘§$B?

ğ‘“$

-1

ğ‘“$>?

ğ‘‚$

ğ‘š$ ğ‘”

Newton equation

axis ğ‘– + 1
(ğ‘$>? )

ğ‘š$ ğ‘” gravity force
all vectors expressed in the
same RF (better RFğ‘– )

ğ‘“$ âˆ’ ğ‘“$>? + ğ‘š$ ğ‘” = ğ‘š$ ğ‘5$

N

linear acceleration of ğ¶$
Robotics 2

5

Newton-Euler equations
link ğ‘–

ğœ”$

TORQUES

ğœ$ torque applied

from link (ğ‘– âˆ’ 1) on link ğ‘–

ğœ$

ğœ$>? torque applied

from link ğ‘– on link (ğ‘– + 1)

ğ‘“$ Ã— ğ‘Ÿ$B?,5$ torque due to ğ‘“$ w.r.t. ğ¶$

ğ‘“$

âˆ’ğ‘“$>? Ã— ğ‘Ÿ$,5$ torque due to âˆ’ğ‘“$>? w.r.t. ğ¶$
Euler equation

-2

ğ‘§$

ğ‘§$B?

ğ‘Ÿ$B?,5$

.ğ‘‚

$B?

axis ğ‘–
(ğ‘$ )

gravity force gives
no torque at ğ¶$

ğ‘Ÿ$,5$

.

ğ‘ªğ’Š

ğ‘“$>?

ğ‘‚$

axis ğ‘– + 1
(ğ‘$>? )
all vectors expressed in
the same RF (RFğ‘– !!)

ğœ$ âˆ’ ğœ$>? + ğ‘“$ Ã— ğ‘Ÿ$B?,5$ âˆ’ğ‘“$>? Ã— ğ‘Ÿ$,5$ = ğ¼$ ğœ”Ì‡ $ + ğœ”$ Ã— ğ¼$ ğœ”$
Robotics 2

ğœ$>?

angular acceleration of body ğ‘–

E
6

Forward recursion
Computing velocities and accelerations
â€¢ â€œmoving framesâ€ algorithm (as for velocities in Lagrange)
â€¢ wherever there is no leading superscript, it is the same as the subscript
ğœ”$ = ğ‘– ğœ”$
â€¢ for simplicity, only revolute joints
(see textbook for the more general treatment)
initializations

ğœ”!

ğœ”Ì‡ !

AR

ğ‘! âˆ’ 0ğ‘”

the gravity force term can be skipped in Newton equation, if added here
Robotics 2

7

Backward recursion
Computing forces and torques
from ğ‘$

to ğ‘$B?

eliminated, if inserted
in forward recursion (ğ‘– =0)

initializations
ğ‘“M>?

F/TR

ri,ci)
from ğ¸$

ğœM>?

ri,ci

to ğ¸$B?

at each step of this recursion, we have two vector equations (ğ‘ğ‘– + ğ¸ğ‘– ) at the
joint providing ğ‘“$ and ğœ$ : these contain ALSO the reaction forces/torques
at the joint axis â‡’ they should be â€œprojectedâ€ next along/around this axis
FP
generalized forces
(in rhs of Euler-Lagrange eqs)
Robotics 2

for prismatic joint
for revolute joint
add here dissipative terms
(here viscous friction only)

ğ‘ scalar
equations
at the end

8

Comments on Newton-Euler method
n

the previous forward/backward recursive formulas can
be evaluated in symbolic or numeric form
n

n

Robotics 2

symbolic
n substituting expressions in a recursive way
n at the end, a closed-form dynamic model is obtained, which
is identical to the one obtained using Euler-Lagrange (or any
other) method
n there is no special convenience in using N-E in this way
numeric
n substituting numeric values (numbers!) at each step
n computational complexity of each step remains constant â‡’
grows in a linear fashion with the number ğ‘ of joints (ğ‘‚(ğ‘))
n strongly recommended for real-time use, especially when the
number ğ‘ of joints is large
9

Newton-Euler algorithm

efficient computational scheme for inverse dynamics
numeric steps
at every instant ğ‘¡

(at robot base)
AR

FP
, ğ‘5?

F/TR
outputs

inputs
,ğ‘5MB?
AR

FP
, ğ‘5M

Robotics 2

F/TR
(force/torque exchange
environment/E-E)

10

Matlab (or C) script
general routine ğ‘ğ¸S (arg1, arg2, arg3)
n

data file (of a specific robot)
n
n
n

n

input
n
n

n

number ğ‘ and types Ïƒ = 0,1 M of joints (revolute/prismatic)
table of DH kinematic parameters
list of ALL dynamic parameters of the links (and of the motors)
vector parameter ğ›¼ = 0ğ‘”, 0 (presence or absence of gravity)
three ordered vector arguments
n typically, samples of joint position, velocity, acceleration
taken from a desired trajectory

output
n
n

Robotics 2

generalized force ğ‘¢ for the complete inverse dynamics
â€¦ or single terms of the dynamic model
11

Examples of output
n

complete inverse dynamics

ğ‘¢ = ğ‘ğ¸ !Y (ğ‘ğ‘‘, ğ‘Ì‡ ] , ğ‘Ìˆ ] ) = ğ‘€(ğ‘] )ğ‘Ìˆ ] + ğ‘(ğ‘] , ğ‘Ì‡ ] ) + ğ‘”(ğ‘] ) = ğ‘¢]
n

gravity terms
ğ‘¢ = ğ‘ğ¸ !Y (ğ‘, 0, 0) = ğ‘”(ğ‘)

n

centrifugal and Coriolis terms
ğ‘¢ = ğ‘ğ¸! (ğ‘, ğ‘,Ì‡ 0) = ğ‘(ğ‘, ğ‘)
Ì‡

n

ğ‘–-th column of the inertia matrix
ğ‘¢ = ğ‘ğ¸! (ğ‘, 0, ğ‘’$ ) = ğ‘€$ (ğ‘)

n

ğ‘’$ = ğ‘– -th column

of identity matrix

generalized momentum
ğ‘¢ = ğ‘ğ¸! ğ‘, 0, ğ‘Ì‡ = ğ‘€ ğ‘ ğ‘Ì‡ = ğ‘

Robotics 2

12

Inverse dynamics of a 2R planar robot

desired (smooth) joint motion:
quintic polynomials for ğ‘? , ğ‘_ with
â‡”
zero vel/acc boundary conditions
o
o
o
o
from (90 , -180 ) to (0 , 90 ) in ğ‘‡ = 1 s
Robotics 2

13

Inverse dynamics of a 2R planar robot

zero
initial torques =
free equilibrium
configuration
+
zero initial
accelerations

final torques

ğ‘¢? â‰  0, ğ‘¢_ = 0

balance
link weights
o
o
in final (0 , 90 )
configuration

motion in vertical plane (under gravity)
both links are thin rods of uniform mass ğ‘š? = 10 kg, ğ‘š_ = 5 kg
Robotics 2

14

Inverse dynamics of a 2R planar robot

torque contributions at the two joints for the desired motion
= total,
= inertial
= Coriolis/centrifugal,
= gravitational
Robotics 2

15

Use of NE routine for simulation
direct dynamics

n

numerical integration, at current state (ğ‘, ğ‘Ì‡ ), of
ğ‘Ìˆ = ğ‘€ B? (ğ‘)[ğ‘¢ â€“ (ğ‘(ğ‘, ğ‘)
Ì‡ + ğ‘”(ğ‘))] = ğ‘€ B? (ğ‘)[ğ‘¢ â€“ ğ‘›(ğ‘, ğ‘)]
Ì‡

n

Coriolis, centrifugal, and gravity terms
ğ‘› = ğ‘ğ¸ !Y (ğ‘, ğ‘,Ì‡ 0)

n

complexity

ğ‘–-th column of the inertia matrix, for ğ‘– = 1, . . , ğ‘
ğ‘‚(ğ‘ _ )

ğ‘€$ = ğ‘ğ¸! (ğ‘, 0, ğ‘’$ )
n

numerical inversion of inertia matrix
ğ¼ğ‘›ğ‘£ğ‘€ = inv(ğ‘€)

n

ğ‘‚(ğ‘)

ğ‘‚(ğ‘ l )

but with small coefficient

given ğ‘¢, integrate acceleration computed as
ğ‘Ìˆ = ğ¼ğ‘›ğ‘£ğ‘€ âˆ— [ğ‘¢ â€“ ğ‘›]

Robotics 2

new state (ğ‘, ğ‘Ì‡ )
and repeat over time ...
16

