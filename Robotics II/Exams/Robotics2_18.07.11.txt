Robotics II
July 11, 2018
Exercise 1
Consider a 2R planar robot, with the two links of length l1 and l2 , having the actuating motors
mounted on the axes of the two revolute joints. Each motor delivers its torque to the driven link
through an elastic transmission, modeled as a torsional spring of stiffness ki > 0, for i = 1, 2. The
robot has no motion reduction elements. In the ith motor-link assembly, for i = 1, 2, let mmi
and Imi be, respectively, the balanced mass and the inertia of the rotor of the motor around its
spinning axis, and mi , dci , and Ii the link mass, the distance of the center of mass of the link
from the preceding joint axis, and the link inertia around its center of mass. Using as generalized
coordinates the angle Î¸mi of the rotor of motor i w.r.t. the preceding link axis, and the angle Î¸i
of link i w.r.t. the preceding link axis, for i = 1, 2, define the 4 Ã— 4 inertia matrix M (q) of the
robot, where q = (Î¸ T Î¸ Tm )T . State explicitly any simplifying assumption that you may wish to
use. Moreover, find a linear parametrization of the inertial term M (q) qÌˆ = Y M (q, qÌˆ) a of the robot
dynamic model in terms of a minimal set of p suitable dynamic coefficients ai , i = 1, . . . , p.
Exercise 2
Consider a 4R planar robot with all links of equal length ` = 0.2 [m]. The robot is in the DH
configuration q = ( 0 Ï€/2 0 Ï€/2 )T [rad] and at rest (qÌ‡ = 0). In this state, we should assign to
the end-effector a desired linear acceleration a = ( 5 0 )T [m/s2 ]. The joint accelerations are taken
as input commands, and are bounded as |qÌˆi | â‰¤ Ai , i = 1, . . . , 4, with the limits A1 = 9, A2 = 6,
A3 = 4, and A4 = 2 [rad/s2 ]. Find, if possible, a feasible joint acceleration qÌˆ âˆˆ R4 that executes
instantaneously the desired Cartesian task, while satisfying these hard bounds. A solution with a
lower norm is preferred, and could be obtained by a straightforward variation of the SNS method
moved to the acceleration level.
Exercise 3
In a visual servoing scheme, n point features with coordinates (ui , vi ), for i = 1, . . . , n, can be
extracted from the image. Define the 2 Ã— 6 interaction matrix JÌ„ between the 6D vector of linear
velocity V âˆˆ R3 and angular velocity â„¦ âˆˆ R3 of the camera and the time derivative of the
coordinates (uÌ„, vÌ„) of the average position of the n point features in the image plane. State all
variables that matrix JÌ„ depends upon.
Exercise 4
For a robot with n degrees of freedom, partition the generalized coordinates as q = (q a , q b ), where
q a has na components, q b has nb components, and na + nb = n. Provide the explicit expressions of
the na -dimensional reduced robot dynamics and of the constraint-preserving forces Î» âˆˆ Rnb , when
the geometric constraint h(q) = q b âˆ’ q b,d = 0 is imposed at all times, with q b,d being constant.
[240 minutes; open books, but no computer or smartphone]

1

Solution
July 11, 2018
Exercise 1
We need to compute the kinetic energy of the two motors and the two links, all in planar motion.
For the motors, we have
Tm1 =

1
Im Î¸Ì‡2 ,
2 1 m1

Tm2 =

1
1
mm2 l12 Î¸Ì‡12 + Im2 (Î¸Ì‡1 + Î¸Ì‡m2 )2 ,
2
2

since the first motor is balanced and its center of mass does not move, while the center of mass of
the second motor is placed on the second joint axis at a distance equal to the link length l1 .
For the links, we have
Tl1 =


1
I1 + m1 d2c1 Î¸Ì‡12 ,
2

Tl2 =

1
1
m2 kv c2 k2 + I2 (Î¸Ì‡1 + Î¸Ì‡2 )2 ,
2
2

with

pc2 =

l1 cos Î¸1 + dc2 cos(Î¸1 + Î¸2 )
l1 sin Î¸1 + dc2 sin(Î¸1 + Î¸2 )


,

v c2 = pÌ‡c2 =

âˆ’(l1 Î¸Ì‡1 sin Î¸1 + dc2 (Î¸Ì‡1 + Î¸Ì‡2 ) sin(Î¸1 + Î¸2 ))
l1 Î¸Ì‡1 cos Î¸1 + dc2 (Î¸Ì‡1 + Î¸Ì‡2 ) cos(Î¸1 + Î¸2 )

!

and thus
kv c2 k2 = l12 Î¸Ì‡12 + d2c2 (Î¸Ì‡1 + Î¸Ì‡2 )2 + 2l1 dc2 Î¸Ì‡1 (Î¸Ì‡1 + Î¸Ì‡2 ) cos Î¸2 .
T
T
= Î¸1 Î¸2 Î¸m1 Î¸m2
. we can write the total kinetic
Therefore, having set q = Î¸ T Î¸ Tm
energy as
1
T = Tm1 + Tl1 + Tm2 + Tl2 = qÌ‡ T M (q)qÌ‡,
2
with the 4 Ã— 4 inertia matrix of the robot given by
ï£¶
ï£«
I1 + m1 d2c1 + I2 + m2 d2c2 + m2 l12
2
ï£¬ + Im + mm l2 + 2m2 l1 dc cos Î¸2 I2 + m2 dc2 + m2 l1 dc2 cos Î¸2 0 Im2 ï£·
2
2 1
2
ï£¬
ï£·
ï£¬
ï£·
2
2
ï£¬
M (q) = ï£¬
I2 + m2 dc2 + m2 l1 dc2 cos Î¸2
I2 + m2 dc2
0
0 ï£·
ï£·.
ï£¬
ï£·
0
0
Im1 0 ï£¸
ï£­
Im2
0
0 Im2
Note that, if we assume that in the kinetic energy of the second motor the contribution of the
angular velocity due to the previous link carrying the motor can be neglected in comparison with
the spinning velocity of the rotor of the motor itself, we would have
1
1
2
Tm2 = Â· Â· Â· + Im2 (Î¸Ì‡1 + Î¸Ì‡m2 )2 ' Â· Â· Â· + Im2 Î¸Ì‡m
,
2
2
2

(1)

and the off-diagonal terms M14 = M41 = Im2 of the inertia matrix would disappear. As a result,
the matrix would become block diagonal, with two 2 Ã— 2 blocks (the second being diagonal) that
pertain to the link kinetic energy and, respectively, to the motor kinetic energy. This assumption
is quite realistic when the motors are connected to the driven links via transmissions with large
reduction ratios (which is not, however, the present case), independently from the presence or not
of elasticity in the transmissions.

2

,

The robot inertia matrix can be rewritten compactly using the following p = 5 dynamic coefficients
a1 = I1 + m1 d2c1 + I2 + m2 l12 + Im2 + mm2 l12
a2 = m2 l1 dc2
a3 = I2 + m2 d2c2
a4 = Im1
a5 = Im2 ,
as

ï£«
ï£¬
ï£¬
M (q) = ï£¬
ï£­

a1 + 2a2 cos Î¸2 a3 + a2 cos Î¸2
a3 + a2 cos Î¸2
a3
0
0
a5
0

0
0
a4
0

a5
0
0
a5

ï£¶
ï£·
ï£·
ï£·.
ï£¸

Thus, the inertial terms in the robot dynamic model can be given a linearly parametrized form as
ï£«

Î¸Ìˆ2

0

Î¸Ìˆm2

ï£¶ï£«

Î¸Ìˆ1 cos Î¸2

Î¸Ìˆ1 + Î¸Ìˆ2

0

0

0

0

Î¸Ìˆm1

0

ï£·ï£¬
ï£·ï£¬
ï£·ï£¬
ï£·ï£¬
ï£¸ï£­

0

0

0

Î¸Ìˆ1 + Î¸Ìˆm2

Î¸Ìˆ1 (2Î¸Ìˆ1 + Î¸Ìˆ2 ) cos Î¸2

ï£¬
ï£¬ 0
M (q)qÌˆ = ï£¬
ï£¬ 0
ï£­
0

a1
a2
a3
a4
a5

ï£¶
ï£·
ï£·
ï£· = Y M (q, qÌˆ)a.
ï£·
ï£¸

We remark that the simplifying assumption (1) would eliminate from Y M the presence of Î¸Ìˆm2 in
element YM,15 and of Î¸Ìˆ1 in YM,45 , but not reduce the number of dynamic coefficients: as a matter
of fact, p = 5 is the smallest possible number of such coefficients.
Exercise 2
The task Jacobian of the planar 4R robot is given by


âˆ’ (s1 + s12 + s123 + s1234 ) âˆ’ (s12 + s123 + s1234 ) âˆ’ (s123 + s1234 ) âˆ’s1234
J (q) = `
, (2)
c1 + c12 + c123 + c1234
c12 + c123 + c1234
c123 + c1234
c1234
and is used, together with its time derivative JÌ‡ (q), in the first- and second-order differential
mappings
v = J (q)qÌ‡,
a = J (q)qÌˆ + JÌ‡ (q)qÌ‡,
a âˆˆ R2 ,
qÌˆ âˆˆ R4 .
Since a minimum norm solution is being sought at the acceleration level, we solve the second-order
differential kinematics in the least squares sense using pseudoinversion as


qÌˆ = J # (q) a âˆ’ JÌ‡ (q)qÌ‡ .
(3)
When q = qÌ„ = ( 0 Ï€/2 0 Ï€/2 )T [rad] and for ` = 0.2 [m], the Jacobian becomes

J := J (qÌ„) =

âˆ’0.4
0

âˆ’0.4
âˆ’0.2

âˆ’0.2
âˆ’0.2

0
âˆ’0.2



Having J full rank1 , any desired task acceleration a in (3) will be exactly realized in the absence
of bounds, or realized at least in direction (possibly in a scaled form) in case the joint accelerations
1 This

property is particularly strong in this case, since all 2 Ã— 2 minors are nonsingular in this configuration.

3

bounds cannot be satisfied. Moreover, since the robot is at rest (qÌ‡ = 0) in q = qÌ„, the relation (3)
collapses into
qÌˆ = J # a.
(4)
In this setting, the SNS (Saturation in the Null Space) method presented originally at the velocity
level can be applied without any modification, except for the acceleration limits Ai â€™s replacing the
velocity ones.
The pseudoinverse solution in (4) provides the joint acceleration with minimum norm. We have
ï£¶
ï£«
ï£¶
ï£«
âˆ’8.3333
âˆ’1.6667 1.6667
ï£¬ âˆ’0.8333 âˆ’0.8333 ï£·  5  ï£¬ âˆ’4.1667 ï£·
ï£·
ï£¬
ï£·
ï£¬
#
T
T âˆ’1
=ï£¬
qÌˆ P S = J a = J (J J ) a = ï£¬
ï£· [rad/s2 ]. (5)
ï£·
ï£¸
ï£­
0
ï£­
0
âˆ’1.6667 ï£¸ 0
4.1667
0.8333
âˆ’2.5
The fourth joint acceleration violates the maximum limit, qÌˆP S,4 = 4.1667 > 2 = A4 , so this is not
a feasible solution. Thus, we search for a feasible solution by using the SNS method.
In step 1 of the SNS method, we saturate the overdriven joint by setting qÌˆ4 = A3 = 2 [rad/s2 ].
Then, the original task is modified by removing the saturated contribution of the fourth joint
acceleration (and discarding the associated column of J ). We rewrite this as
ï£«
ï£¶
 

 
 
 qÌˆ1
5
0
5
âˆ’0.4 âˆ’0.4 âˆ’0.2 ï£¬
ï£·
a1 = a âˆ’ J 4 A4 =
âˆ’2
=
=
ï£­ qÌˆ2 ï£¸ = J âˆ’4 qÌˆ âˆ’4 ,
0
âˆ’0.2
0.4
0
âˆ’0.2 âˆ’0.2
qÌˆ3
where J âˆ’i is the Jacobian obtained by deleting the ith column and, similarly, qÌˆ âˆ’i is the vector
of joint accelerations without the ith component. We recompute next the contribution of the
remaining active joints, by pseudoinverting the J âˆ’4 matrix for the modified task. We obtain
ï£¶
ï£¶
ï£«
ï£«


âˆ’9.7778
âˆ’2.2222 3.3333
5
ï£·
ï£·
ï£¬
ï£¬
qÌˆ P Sâˆ’4 = J #
= ï£­ âˆ’3.4444 ï£¸ [rad/s2 ],
âˆ’4 a1 = ï£­ âˆ’0.5556 âˆ’1.6667 ï£¸
0.4
1.4444
0.5556 âˆ’3.3333
to be completed with the additional choice qÌˆ4 = A4 = 2. The first joint acceleration violates now
its limit (on the negative side), qÌˆP Sâˆ’4 ,1 = âˆ’9.7778 < âˆ’9 = âˆ’A1 . So. this is not yet a feasible
solution and we proceed with the SNS method.
In step 2, we saturate also the first overdriven joint by setting qÌˆ1 = âˆ’A1 = âˆ’9 [rad/s2 ]. The
original task is modified by removing both saturated acceleration contributions by the first and
fourth joints (discarding the two associated columns of J ). We rewrite this as



 

5
âˆ’0.4
1.4
a2 = a âˆ’ J 4 A4 âˆ’ J 1 (âˆ’A1 ) = a1 + J 1 A1 =
+9
=
0.4
0
0.4
and

a2 =

1.4
0.4




=

âˆ’0.4
âˆ’0.2

âˆ’0.2
âˆ’0.2



qÌˆ2
qÌˆ3


= J âˆ’14 qÌˆ âˆ’14 ,

with obvious notation. We recompute next the contribution of the remaining active joints, by
pseudoinverting the (now square and nonsingular) matrix J âˆ’23 for the modified task. We obtain


 

1.4
âˆ’5
âˆ’5
5
âˆ’1
qÌˆ P Sâˆ’14 = J #
a
=
J
a
=
=
[rad/s2 ],
âˆ’14 2
âˆ’14 2
5 âˆ’10
0.4
3
4

with qÌˆ1 = âˆ’A1 = âˆ’9 and qÌˆ4 = A4 = 2. All bounds are now satisfied and the obtained joint
acceleration is feasible. Recomposing the complete vector, we have the solution
ï£¶
ï£«
âˆ’9
ï£¬ âˆ’5 ï£·
ï£·
ï£¬
with J qÌˆ SN S = a and kqÌˆ SN S k = 10.9087.
(6)
qÌˆ SN S = ï£¬
ï£· [rad/s2 ],
ï£­ 3 ï£¸
2
This feasible solution is the one having the least possible norm.
The solution (6) is not the only feasible one. As a matter of fact, one could have attempted a
heuristic procedure to find a (set of) solution(s) in a reasonable but otherwise arbitrary way, e.g.,
by fixing one component of the input acceleration to one of its (upper or lower) limits, and working
out then the rest of the solution. For this, reconsider the original equation to be solved, written
explicitly in terms of a linear system in the joint accelerations (scaling the coefficients so as to
become all integers):


 
2qÌˆ1 + 2qÌˆ2 + qÌˆ3 = âˆ’25
âˆ’0.4 âˆ’0.4 âˆ’0.2
0
5
J (qÌ„) qÌˆ = a â‡’
qÌˆ =
â‡â‡’
0
âˆ’0.2 âˆ’0.2 âˆ’0.2
0
qÌˆ2 + qÌˆ3 + qÌˆ4 = 0.
By inspection, we find that choosing qÌˆ1 = âˆ’A1 = âˆ’9 will contribute at best to the solution of
the first scalar equation, being this variable present only in this equation and having the largest
coefficient (and thus the highest sensitivity). In addition, set parametrically qÌˆ4 = Î± in the second
scalar equation. We have then


 
 



 
qÌˆ2
2 1
âˆ’25 + 2A1
âˆ’7
qÌˆ2
âˆ’7 + Î±
=
=
â‡’
,
=
1 1
qÌˆ3
âˆ’qÌˆ4
âˆ’Î±
qÌˆ3
7 âˆ’ 2Î±
with the components of the parametric solution that need to satisfy the bounds
|qÌˆ2 | â‰¤ A2 = 6
|qÌˆ3 | â‰¤ A3 = 4
|qÌˆ4 | â‰¤ A4 = 2

âˆ’6 â‰¤ âˆ’7 + Î± â‰¤ 6
â‡â‡’

âˆ’4 â‰¤ 7 âˆ’ 2Î± â‰¤ 4

â‡’

Î± âˆˆ [1.5, 2].

âˆ’2 â‰¤ Î± â‰¤ 2

The feasible interval for Î± comes from the simultaneous intersection of the set of inequalities.
Therefore, we have a parametrized family of feasible solutions in the form
ï£«
ï£¶
âˆ’9
ï£¬ âˆ’7 + Î± ï£·
p
ï£¬
ï£·
qÌˆ(Î±) = ï£¬
with kqÌˆ(Î±)k = 6Î±2 âˆ’ 42Î± + 179,
Î± âˆˆ [1.5, 2]. (7)
ï£· [rad/s2 ],
ï£­ 7 âˆ’ 2Î± ï£¸
Î±
We see immediately that qÌˆ SN S = qÌˆ(Î± = 2). Moreover, the quadratic polynomial in the norm of
qÌˆ(Î±) has an unconstrained minimum at Î± = 3.5, which is outside the interval [1.5, 2] of feasibility
for Î±. Therefore, the minimum norm is obtained at the upper limit Î± = 2 of this closed interval,
i.e., with qÌˆ SN S . Any other feasible solution will have a larger norm than qÌˆ SN S .
We finally remark that, in order to find a feasible joint acceleration, a different (say, more conventional) solution would have been to use pseudo-inversion with a scaling of the original task
acceleration a (in intensity, but without a change in direction). This is done as follows. From (5),
we compute the necessary scaling factor s > 1 as




8.3333 4.1667 0 4.1667
|qÌˆP S,i |
, i = 1, . . . , 4 = max
,
, ,
= 2.0833.
s = max
Ai
9
6
4
2
5

This value is imposed by the exceeding acceleration of the fourth joint. We compute then
ï£¶
ï£«
âˆ’4


ï£¬ âˆ’2 ï£·
2.4
a
ï£·
ï£¬
ascaled = =
â‡’
qÌˆ P S,scaled = J # ascaled = ï£¬
ï£·.
s
ï£­ 0 ï£¸
0
2
Indeed, the obtained joint acceleration has lower norm than qÌˆ SN S , but realizes in fact only 2.4/5 =
48% of the desired task acceleration of the original problem.
Exercise 3
The interaction matrix of a generic point feature with image coordinates (ui , vi ) is known to be
ï£«
ï£¶


Î»
ui
ui vi
u2i
0
âˆ’ Î»+
vi ï£·
ï£¬ âˆ’Z
Zi
Zi
Î»
i
ï£·,
J pi (ui , vi , Zi ) = ï£¬
2
ï£­
ï£¸
vi
vi
ui v i
Î»
Î»+
âˆ’
âˆ’ui
0
âˆ’
Zi Zi
Î»
Zi
with



uÌ‡i
vÌ‡i




= J pi (ui , vi , Zi )

V
â„¦


,

where the parameter Î» > 0 is the constant focal length of the camera and Zi is the depth of the
Cartesian point P i âˆˆ R3 in the pre-image of (ui , vi ). The average position of n point features in
the image plane has coordinates
ï£«
ï£¶
1 Pn
 

n 
ï£¬ n i=1 ui ï£·
uÌ„
1 X ui
ï£¬
ï£·
=ï£­
.
ï£¸= n
vÌ„
vi
1 Pn
i=1
v
i
n i=1
Therefore
! 
 

 
n 
n
uÌ„Ë™
1 X uÌ‡i
1X
V
V
J p (ui , vi , Zi )
= JÌ„ (u, v, Z)
=
=
â„¦
â„¦
n i=1 vÌ‡i
n i=1 i
vÌ„Ë™
ï£«
ï£¶

Pn
Pn ui
Pn ui vi
Pn u2i 
 
1
1
1
âˆ’ nÎ» i=1 Z1i
0
âˆ’
Î»
+
vÌ„
V
i=1 Zi
i=1 Zi
i=1 Î»
n
n
n
ï£¸
=ï£­
,
Pn 1 1 Pn vi
Pn vi2
Pn ui vi
â„¦
Î»
1
1
0
âˆ’ n i=1 Zi n i=1 Zi Î» + n i=1 Î»
âˆ’ n i=1 Zi
âˆ’uÌ„
with a dependence of the interaction matrix JÌ„ on the components of u = (u1 . . . un )T âˆˆ Rn ,
v = (v1 . . . vn )T âˆˆ Rn , and Z = (Z1 . . . Zn )T âˆˆ Rn .
Exercise 4
The nb -dimensional geometric constraint
h(q) = q b âˆ’ q b,d = 0

(8)

has a simple associated Jacobian
A(q) =

âˆ‚h(q)
=
âˆ‚q
6

O

I



.

Therefore, considering the decomposition q = (q a , q b ), the dynamic model of the constrained robot
can be partitioned as follows
!  
    
M aa (q) M ab (q)
qÌˆ a
na (q, qÌ‡)
Ï„a
0
T
M (q)qÌˆ+n(q, qÌ‡) = Ï„ +A (q)Î» â‡’
+
=
+
,
T
qÌˆ b
nb (q, qÌ‡)
Ï„b
Î»
M ab (q) M bb (q)
where n(q, qÌ‡) collects all non-inertial terms in the model and Î» âˆˆ Rnb is the vector of Lagrange
multipliers associated to the geometric constraints.
To obtain a reduced dynamic model (with only n âˆ’ nb = na independent coordinates), we proceed
in the general way by bordering A(q) with the rows of a matrix D(q), so as to obtain a square
and nonsingular transformation matrix. The situation is particularly simple since A is constant,
and so can be chosen D. A globally valid choice is then


A
D




=

O I
I O




â‡’

A
D

âˆ’1


=

O
I

I
O


=

E

F



.

Thus, the following bidirectional mappings are established between the generalized velocity qÌ‡ (and
acceleration qÌˆ) and the pseudo-velocity v (and pseudo-acceleration vÌ‡):





I
I
vÌ‡.
v,
qÌˆ =
vÌ‡ = qÌˆ a
â‡â‡’
qÌ‡ = F v =
v = D qÌ‡ = I O qÌ‡ = qÌ‡ a ,
O
O
Dropping dependencies, the reduced inertia matrix and the reduced non-inertial dynamic terms
are computed as



I
T
= M aa ,
F MF = I O M
O


 Ï„ a âˆ’ na
T
F (Ï„ âˆ’ n) = I O
= Ï„ a âˆ’ na .
Ï„ b âˆ’ nb
Therefore, taking into account that q b = q b,d and qÌ‡ b = qÌˆ b = 0 from (8), the reduced dynamic
model becomes
M aa (q a , q b,d ) qÌˆ a + na (q a , q b,d , qÌ‡ a , 0) = Ï„ a ,
while the Lagrange multipliers (i.e., the forces that will preserve the geometric constraints when
attempting their violation) takes the expression
!

 
!

âˆ—
âˆ—
âˆ—
T
Î» = E (M F vÌ‡ + n âˆ’ Ï„ ) = O I
qÌˆ a +
âˆ’
,
nb
Ï„b
M Tab
or, by expliciting the dependencies,
Î» = M Tab (q a , q b,d ) qÌˆ a + nb (q a , q b,d , qÌ‡ a , 0) âˆ’ Ï„ b .
We conclude with two extra comments. The following torque command, expressed as a function
of the constrained robot state and of the arbitrary input torque Ï„ a ,
Ï„ b = M Tab (q a , q b,d ) qÌˆ a + nb (q a , q b,d , qÌ‡ a , 0)

= M Tab (q a , q b,d )M âˆ’1
aa (q a , q b,d ) Ï„ a âˆ’ na (q a , q b,d , qÌ‡ a , 0) + nb (q a , q b,d , qÌ‡ a , 0),
will guarantee Î» â‰¡ 0 at all times, resulting in a feasible motion with minimal internal effort. On
the other hand, the feedback linearizing control law that achieves (in a decoupled way) a desired
7

value a for the acceleration qÌˆ a of the free variables and a desired constraint force Î» = Î»d is given
by
!


M aa (q a , q b,d )
O
Ï„ =
a+
Î»d + n(q a , q b,d , qÌ‡ a , 0),
I
M Tab q a , q b,d )
or
Ï„ a = M aa (q a , q b,d ) a + na (q a , q b,d , qÌ‡ a , 0),
Ï„ b = M Tab (q a , q b,d ) a + nb (q a , q b,d , qÌ‡ a , 0) + Î»d .
âˆ—âˆ—âˆ—âˆ—âˆ—

8

