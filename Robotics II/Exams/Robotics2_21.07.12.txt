Robotics 2
July 12, 2021
Exercise #1
Consider the planar 3R robot in Fig. 1. The three links have all equal length L. The robot
is controlled by a joint acceleration command u = qÌˆ âˆˆ R3 . The input commands are bounded
componentwise as |ui | â‰¤ Umax,i , for i = 1, 2, 3. Moreover, let p = f (q) âˆˆ R2 be the end-effector
position. At a given instant t = t0 , the robot is in a generic state (q(t0 ), qÌ‡(t0 )) = (q 0 , qÌ‡ 0 ) âˆˆ R6 .
Assume in the following that it is always qÌ‡ 0 6= 0. For this robot, provide (if it exists) a feasible
solution u0 = u(t0 ) to each of the following problems. If there are multiple feasible solutions,
provide the one having minimum norm.

q3

y0
L

q2

L

P

L

q1
x0

Figure 1: A planar 3R robot.
a) Is it possible to define u0 so that the end-effector acceleration instantaneously vanishes, i.e.,
pÌˆ0 = pÌˆ(t0 ) = 0? If so, under which conditions on the current robot state (q 0 , qÌ‡ 0 )? Provide a
specific example (or counterexample) illustrating the situation, giving the numerical values of
q 0 , qÌ‡ 0 , and u0 (and of the resulting pÌˆ0 , if different from zero).
b) Which command u0 should be applied to stop as fast as possible the motion of the robot joints?
Provide an example with numerical values of q 0 , qÌ‡ 0 , u0 , and of the obtained pÌˆ0 .
Exercise #2
The dynamics of a robot arm with n joints that may be subject to actuator faults can be written
in a standard form as
M (q)qÌˆ + c(q, qÌ‡) + g(q) = Ï„ âˆ’ Ï„ f ,
(1)
where Ï„ f âˆˆ Rn is an additional torque that models a generic actuator fault when present. Consider now as fault an incipient block of the joint/motor i, with i âˆˆ {1, . . . , n}. This situation
is represented by an acceleration of the faulted joint that behaves as qÌˆi = âˆ’Î»i qÌ‡i , with Î»i  1,
until the joint eventually stops. Show that this fault can be described as in (1), by providing the
model-based expression of the fault Ï„f,i (with Ï„f,j â‰¡ 0, for j 6= i). Find also the expression of the
accelerations of the other joints, j 6= i, at the instant when this type of fault occurs.

1

Exercise #3
The 3-dof RPR robot in Fig. 2 moves on a horizontal plane. The robot should asymptotically
track a smooth joint trajectory q d (t) in the presence of a partly unknown dynamic model. In fact,
only the dynamic parameters m3 , dc3 , and I3 are assumed to be known. Derive first the dynamic
model of this robot, neglecting any dissipative frictional effect.
yw

m3,I3
âŠ•

dc3

q3

âŠ•

dc2
m2,I2

q2

q1

m1,I1

xw

âŠ•

dc1

Figure 2: A planar RPR robot with its generalized coordinates and dynamic parameters.
Consider next the following adaptive trajectory tracking control law that takes advantage of the
partly known dynamics
Ï„ = Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) aÌ‚ U + Y K (q, qÌ‡, qÌ‡ r , qÌˆ r ) aK + K P (q d âˆ’ q) + K D (qÌ‡ d âˆ’ qÌ‡)
Ë™ U = Î“ Y T (q, qÌ‡, qÌ‡ , qÌˆ ) (qÌ‡ âˆ’ qÌ‡),
aÌ‚
r
r
r
U

(2)

âˆ’1
where qÌ‡ r = qÌ‡ d + Î› (q d âˆ’ q) = qÌ‡ d + K D
K P (q d âˆ’ q), K P > 0, K D > 0, and Î“ > 0 are diagonal
gain matrices, a U âˆˆ Rpu and aK âˆˆ Rpk are vectors containing, respectively, the unknown and the
known dynamic coefficients of the robot model. The 3 Ã— pu matrix Y U and 3 Ã— pk matrix Y K are
the associated regressors in the linear parametrization of the dynamic model. Provide the explicit
expressions of all terms in the adaptive control law (2). If time remains, sketch a proof of the
asymptotic stability of the trajectory tracking error with this modified adaptive law.

[180 minutes (3 hours); open books]

2

Solution
July 12, 2021
Exercise #1
The second-order differential kinematics of a robot with n joints performing a m-dimensional task
(with m â‰¤ n) is
pÌˆ = J (q)qÌˆ + JÌ‡ (q)qÌ‡ = J (q)u + h(q, qÌ‡),
(3)
with vector h âˆˆ Rm being quadratic in qÌ‡. The joint acceleration qÌˆ âˆˆ Rn is taken here as input
command u. For the planar 3R robot of Fig. 1, we have n = 3, m = 2, and the terms in (3) are
the 2 Ã— 3 task Jacobian


âˆ’ (s1 + s12 + s123 ) âˆ’ (s12 + s123 ) âˆ’s123
âˆ‚f (q)
=L
,
J (q) =
âˆ‚q
c1 + c12 + c123
c12 + c123
c123
its time derivative
JÌ‡ (q) = âˆ’L Â·


c1 qÌ‡1 + c12 (qÌ‡1 + qÌ‡2 ) + c123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )

c12 (qÌ‡1 + qÌ‡2 ) + c123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )

c123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )

s1 qÌ‡1 + s12 (qÌ‡1 + qÌ‡2 ) + s123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )

s12 (qÌ‡1 + qÌ‡2 ) + s123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )

s123 (qÌ‡1 + qÌ‡2 + qÌ‡3 )


,

and the product of matrix JÌ‡ by the joint velocity qÌ‡


(c1 + c12 + c123 ) qÌ‡12 + 2 (c12 + c123 ) qÌ‡1 qÌ‡2 + 2 c123 qÌ‡1 qÌ‡3 + (c12 + c123 ) qÌ‡22 + 2 c123 qÌ‡2 qÌ‡3 + c123 qÌ‡32
h(q, qÌ‡) = âˆ’L
,
2
2
2
(s1 + s12 + s123 ) qÌ‡1 + 2 (s12 + s123 ) qÌ‡1 qÌ‡2 + 2 s123 qÌ‡1 qÌ‡3 + (s12 + s123 ) qÌ‡2 + 2 s123 qÌ‡2 qÌ‡3 + s123 qÌ‡3

having used the shorthand notation for trigonometric functions (e.g., c123 = cos(q1 + q2 + q3 )).
Problem #1a
The minimum norm solution of (3) for pÌˆ = 0 at a generic state (q 0 , qÌ‡ 0 ) is
u0 = âˆ’J # (q 0 )h(q 0 , qÌ‡ 0 ).

(4)

In the absence of bounds on the command u0 , this acceleration would return pÌˆ0 = 0 if and only
if h(q 0 , qÌ‡ 0 ) âˆˆ R {J (q 0 )}. In particular, when rank {J (q 0 )} = 2 (regular case), this condition is
always satisfied and we only need to check whether u0 is feasible, i.e., if |u0,i | â‰¤ Umax,i , for all
i = 1, 2, 3. If so, then we stop. The same would happen in the singular case (rank {J (q 0 )} < 2).
If instead the acceleration command (4) is unfeasible, we should attempt the use of the general
solution to (3) for pÌˆ = 0, namely


(5)
u0 = âˆ’J # (q 0 )h(q 0 , qÌ‡ 0 ) + I âˆ’ J # (q 0 )J (q 0 ) qÌˆ 0 ,
with an extra joint acceleration qÌˆ 0 projected in the null space of J . This term may possibly help in
recovering feasibility when the preferred minimum norm solution (4) is unfeasible. The definition
of the actual command (5) is obtained by a simple variant of the SNS (Saturation in the Null
Space) method for redundant robots.
Consider for simplicity only the regular case for the Jacobian, rank {J (q 0 )} = 2. Taking into
account that there is only nâˆ’m = 1 degree of redundancy in the problem, if two (or all) of the scalar
components of (4) are out of bounds, then no feasible solution will exist in any case. Otherwise,
Algorithm 1 (written in pseudo-code) will provide a feasible solution, if one exists. The bounds on
T
the commands are organized in vector form as U max = Umax,1 Umax,2 Umax,3
âˆˆ R3 . We set
also J 0 = J (q 0 ), JÌ‡ 0 = JÌ‡ (q 0 ), and h0 = h(q 0 , qÌ‡ 0 ) = JÌ‡ 0 qÌ‡ 0 .
3

Algorithm 1 SNS method for finding a feasible solution, if it exists (case n = 3, m = 2)
if the command u0 in (4) satisfies |u0 | â‰¤ U max (componentwise) then
STOP % the minimum norm solution (4) is feasible and returns already pÌˆ0 = 0
else

j âˆ— = arg maxi=1,2,3 J #
% it is then |u0,j âˆ— | > Umax,j âˆ— ; by assumption,
0 h0 i
5:
% u0,j âˆ— will be the only command out of bounds

#
6:
set u0,j âˆ— = sign âˆ’J 0 h0 j âˆ— Umax,j âˆ— % the overdriven command is now saturated
1:

2:
3:
4:

7:
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:

define the 2 Ã— 2 matrix JÌ„ {âˆ’j âˆ— } by deleting the j âˆ— -th column J j âˆ— from J 0 ,
u{âˆ’j âˆ— } âˆˆ R2 by deleting uj âˆ— from u, and U max,{âˆ’j âˆ— } âˆˆ R2 deleting Umax,j âˆ— from U max
set a = J j âˆ— u0,j âˆ— + h0 % . . . one needs to solve JÌ„ {âˆ’j âˆ— } u{âˆ’j âˆ— } + a = 0

#
compute u0,{âˆ’j âˆ— } = âˆ’JÌ„ {âˆ’j âˆ— } a
% . . . a unique solution if rank JÌ„ {âˆ’j âˆ— } = 2 !!
if u0,{âˆ’j âˆ— } â‰¤ U max,{âˆ’j âˆ— } (componentwise) then
recompose u0,SNS from u0,j âˆ— and u0,{âˆ’j âˆ— }
STOP % a new feasible solution u0,SNS has been found, returning pÌˆ0 = 0
else
EXIT
% there is no feasible solution providing pÌˆ0 = 0
end if
end if

We provide next several numerical examples illustrating different situations1 . In all cases, we have
set L = 1 [m] for the link lengths and chosen
ï£¶
ï£¶ ï£«
ï£«
47.1239
15 Ï€
ï£·
ï£· ï£¬
ï£¬
U max = ï£­ 10 Ï€ ï£¸ = ï£­ 31.4159 ï£¸ [rad/s2 ]
31.4159
10 Ï€
as bounds for the acceleration commands. The same data will be used also for Problem #1b of
this Exercise. Computations are performed in MATLAB.
1. Regular configuration q 0 = (0, Ï€/2, Ï€/2) [rad], joint velocity qÌ‡ 0 = (Ï€, Ï€, 0) [rad/s]
We evaluate the terms in (3)



âˆ’1 âˆ’1 0
Ï€
, JÌ‡ 0 =
J0 =
âˆ’2Ï€
0 âˆ’1 âˆ’1

2Ï€
âˆ’2Ï€

2Ï€
0




,

h0 =

3 Ï€2
âˆ’4 Ï€ 2




=

29.6088
âˆ’39.4784


,

and compute the pseudoinverse as
ï£«

ï£¶
1/3
ï£·
T
T
âˆ’1/3 ï£¸ .
J#
0 = J0 J0 J0
âˆ’2/3
T
Note that the end-effector velocity pÌ‡0 = J 0 qÌ‡ 0 = âˆ’2Ï€ âˆ’Ï€
[m/s] is different from zero.
Applying the minimum norm solution (4), we obtain the feasible command
ï£«
ï£¶ ï£«
ï£¶
10 Ï€ 2 /3
32.8987
ï£¬
ï£· ï£¬
ï£·
2
2
u0 = âˆ’J #
0 h0 = ï£­ âˆ’Ï€ /3 ï£¸ = ï£­ âˆ’3.2899 ï£¸ [rad/s ],
2
âˆ’11 Ï€ /3
âˆ’36.1885


âˆ’1

which returns pÌˆ0 = 0.
1 Indeed,

only one example was requested in the text.

4

âˆ’2/3
ï£¬
= ï£­ âˆ’1/3
1/3

2. Same regular configuration q 0 = (0, Ï€/2, Ï€/2) [rad], new velocity qÌ‡ 0 = (Ï€, Ï€, âˆ’Ï€/4) [rad/s]
The Jacobian J 0 and its pseudoinverse J #
0 are the same as before. The different terms to be
computed are

 

2.3562
5.4978 5.4978
3Ï€/4 7Ï€/4 7Ï€/4
=
JÌ‡ 0 =
âˆ’6.2832 âˆ’6.2832
0
âˆ’2Ï€ âˆ’2Ï€
0
and

h0 =

33 Ï€ 2 /16
âˆ’4 Ï€ 2




=

20.3561
âˆ’39.4784


.

T
The end-effector velocity is pÌ‡0 = âˆ’2Ï€ âˆ’3Ï€/4 6= 0. The minimum norm solution (4) is now
ï£¶
ï£«
ï£¶ ï£«
26.7302
65 Ï€ 2 /24
ï£·
ï£¬
ï£· ï£¬
2
2
u0 = âˆ’J #
0 h0 = ï£­ âˆ’31 Ï€ /48 ï£¸ = ï£­ âˆ’6.3741 ï£¸ [rad/s ],
2
âˆ’33.1043
âˆ’161 Ï€ /48
which is unfeasible, being the third joint acceleration u0,3 = âˆ’33.1043 larger (in module) than
its bound Umax,3 = 31.4159. The other two acceleration commands remain instead within their
bounds, so that we can apply Algorithm 1 to check if a feasible solution can be found by the
SNS method. Being j âˆ— = 3, we set u0,3 = âˆ’Umax,3 = âˆ’10 Ï€ = âˆ’31.4159 (saturation to the
closest limit, the negative one) and compute




 


0
33 Ï€ 2 /16
20.3561
âˆ’1 âˆ’1
, a = âˆ’J 3 Umax,3 + h0 = âˆ’
10 Ï€ +
=
.
JÌ„ {âˆ’3} =
âˆ’1
âˆ’4 Ï€ 2
âˆ’8.0625
0 âˆ’1
Thus
ï£¶
28.4186
ï£·
ï£¬
= ï£­ âˆ’8.0625 ï£¸ .
âˆ’31.4159
ï£«

#

âˆ’1

u0,{âˆ’3} = âˆ’JÌ„ {âˆ’3} a = âˆ’JÌ„ {âˆ’3} a =



28.4186
âˆ’8.0625


â‡’

u0,SNS

The SNS result u0,SNS is now a feasible solution and returns again pÌˆ0 = 0.
3. Singular configuration q 0 = (0, 0, Ï€) [rad], joint velocity qÌ‡ 0 = (Ï€/2, âˆ’Ï€, Ï€/2) [rad/s]
The robot has the second link stretched and the third folded. This is a singular configuration
since


 
0 0 0
0
J0 =
â‡’
rank {J 0 } = 1,
R{J 0 } =
.
1 0 âˆ’1
1
The end-effector is placed at p0 = f (q 0 ) = (1, 0). Note also
now
ï£«
Ï€/2
ï£¬
pÌ‡0 = J 0 qÌ‡ 0 = 0
â‡â‡’
qÌ‡ 0 = ï£­ âˆ’Ï€
Ï€/2

that the end-effector velocity is
ï£¶
ï£·
ï£¸ âˆˆ N {J 0 }.

We evaluate the other terms in (3):



 

0 Ï€/2 0
âˆ’Ï€ 2 /2
âˆ’4.9348
JÌ‡ 0 =
,
h0 =
=
0
0
0
0
0

5

â‡’

h0 6âˆˆ R{J 0 }.

Computing the pseudoinverse of the singular task Jacobian,
ï£«
ï£¶
0 0.5
ï£¬
ï£·
0 ï£¸,
J#
0 =ï£­ 0
0 âˆ’0.5
we obtain that the minimum norm solution (4) is simply u0 = âˆ’J #
0 h0 = 0. Therefore, the
end-effector acceleration cannot be modified in any case, remaining equal to


âˆ’4.9348
pÌˆ0 = h0 =
6= 0.
0
4. Another singular case q 0 = (0, Ï€, âˆ’Ï€) [rad], same joint velocity qÌ‡ 0 = (Ï€/2, âˆ’Ï€, Ï€/2) [rad/s]
In this last example, the robot has the second and third links both folded. We are again in a
singularity, being


 
0 0 0
0
J0 =
â‡’
rank {J 0 } = 1,
R{J 0 } =
.
1 0 1
1
The end-effector position p0 is the same as in the previous example. On the other hand, the
end-effector velocity is now
 
0
pÌ‡0 = J 0 qÌ‡ 0 =
6= 0
â‡â‡’
pÌ‡0 âˆˆ R{J 0 }.
Ï€
Moreover, being

JÌ‡ 0 =

âˆ’Ï€
0

âˆ’Ï€/2
0

0
0


,

h0 = JÌ‡ 0 qÌ‡ 0 = 0 (!!),

the minimum norm solution (4) will be u0 = âˆ’J #
0 h0 = 0 as in the previous example. However,
the (feasible) solution u0 will produce now pÌˆ0 = h0 = 0, keeping thus the end-effector at the
same instantaneous velocity pÌ‡0 .
Problem #1b
There is a unique command u0 that should be applied to stop as fast as possible the motion of the
robot joints. This is given componentwise by
u0,i = âˆ’ Umax,i sign (qÌ‡0,i ) ,

i = 1, 2, 3,

(6)

where the sign function takes the value 0 when its argument is 0. The logic is that each positive
(negative) component of the initial velocity qÌ‡ 0 is counterbalanced by the maximum negative (positive) value of its associated acceleration. Keeping the same strategy (6) also after t = t0 will let
the robot eventually stop in the minimum (and finite!) possible time.
Taking as example the same initial state as in case 3 of Problem #1a, with qÌ‡ 0 = (Ï€/2, âˆ’Ï€, Ï€/2) [rad/s],
we have
ï£«
ï£¶ ï£«
ï£¶
âˆ’Umax,1
âˆ’15 Ï€



 

0 0 0
âˆ’Ï€ 2 /2
âˆ’Ï€ 2 /2
ï£¬
ï£· ï£¬
ï£·
u0 = ï£­ Umax,2 ï£¸ = ï£­ 10 Ï€ ï£¸ â‡’ pÌˆ0 = J 0 u0 +h0 =
u0 +
=
.
1 0 âˆ’1
0
âˆ’5 Ï€
âˆ’Umax,3
âˆ’10 Ï€
Note that it is pÌ‡0 = 0 in this case. Thus, in order to stop the overall joint motion of the robot as
fast as possible, the end-effector should be brought in motion at time t = t0 by such pÌˆ0 6= 0.
6

Exercise #2
Denote the inverse of the (symmetric) robot inertia matrix as
ï£¶
ï£« T
h1 (q)
ï£¬ hT (q) ï£·
ï£·
ï£¬ 2
âˆ’1
ï£·,
H(q) = M (q) = ï£¬
..
ï£·
ï£¬
ï£¸
ï£­
.
T
hn (q)
with hi (q) being the i-th column of H(q), for i = 1, 2, . . . , n. Also, denote by hii (q) the i-th
element on the diagonal of H(q), for i = 1, 2, . . . , n.
With reference to the dynamic model (1), the incipient blocking fault of the motor at the joint i
is modeled by a vector Ï„ f âˆˆ Rn with the single nonzero i-th component having the expression

1  T
Ï„f,i =
hi (q) (Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q)) + Î»i qÌ‡i ,
Î»i  1,
(7)
hii (q)
whereas Ï„f,j = 0, for all j 6= i.
In fact, since the acceleration vector qÌˆ âˆˆ Rn is given by
qÌˆ = H(q) (Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q) âˆ’ Ï„ f ) ,
using (7), the scalar component of the acceleration at joint i will be
ï£« ï£¶
ï£¶
ï£«
0
ï£¬ . ï£·
ï£·
ï£¬
ï£¬ .. ï£·
ï£·
ï£¬
ï£·
ï£¬ ï£·
ï£¬
ï£¬ ï£·
ï£·
ï£¬
T
qÌˆi = hi (q) ï£¬Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q) âˆ’ ï£¬ 1 ï£· Ï„f,i ï£·
ï£¬ ï£·
ï£·
ï£¬
ï£¬ .. ï£·
ï£·
ï£¬
ï£­ . ï£¸
ï£¸
ï£­
0

1  T
= hTi (q) (Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q)) âˆ’ hii (q) Â·
hi (q) (Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q)) + Î»i qÌ‡i
hii (q)
= âˆ’Î»i qÌ‡i ,
as requested. Moreover, the acceleration at any other joint j 6= i is
qÌˆj = hTj (q) (Ï„ âˆ’ c(q, qÌ‡) âˆ’ g(q)) âˆ’ hji (q) Ï„f,i ,
showing that the fault of motor i will affect also the acceleration of the other joints, because of the
inertial couplings of the inverse of the robot inertia matrix (the off-diagonal terms hji (q), j 6= i).
Exercise #3
The robot in Fig. 2 has n = 3 joints and moves on the horizontal plane. Neglecting friction effects,
its dynamic model is
M (q)qÌˆ + c(q, qÌ‡) = Ï„ .
In computing the kinetic energy T of the robot, we take into account that the motion is planar;
thus, linear velocities will be 2D vectors in the plane (xw , y w ), while angular velocities will be just
scalars (in the z w -direction). For the first link, it is
T1 =


1
I1 + m1 d2c1 qÌ‡12 .
2
7

For the second link, since

âˆ’ sin q1
+ (q2 âˆ’ dc2 ) qÌ‡1
cos q1




âˆ’ sin q1
qÌ‡2
âˆ’ sin q1
= R(q1 )
,
cos q1
(q2 âˆ’ dc2 ) qÌ‡1
cos q1



pc2 = (q2 âˆ’ dc2 )

cos q1
sin q1

v c2 = pÌ‡c2 = qÌ‡2


â‡’


=

cos q1
sin q1

cos q1
sin q1





it follows


1
1
1
I2 Ï‰22 + m2 v Tc2 v c2 =
I2 qÌ‡12 + m2 (q2 âˆ’ dc2 )2 qÌ‡12 + qÌ‡22 .
2
2
2
For the third link, from


q2 cos q1 + dc3 cos(q1 + q3 )
pc3 =
q2 sin q1 + dc3 sin(q1 + q3 )


cos q1 qÌ‡2 âˆ’ q2 sin q1 qÌ‡1 âˆ’ dc3 sin(q1 + q3 )(qÌ‡1 + qÌ‡3 )
,
â‡’ v c3 =
sin q1 qÌ‡2 + q2 cos q1 qÌ‡1 + dc3 cos(q1 + q3 )(qÌ‡1 + qÌ‡3 )
T2 =

we obtain
1
1
I3 Ï‰32 + m3 v Tc3 v c3
2
2


1
1
2
2
= I3 (qÌ‡1 + qÌ‡3 ) + m3 q22 qÌ‡12 + qÌ‡22 + d2c3 (qÌ‡1 + qÌ‡3 ) + 2 dc3 (q2 cos q3 qÌ‡1 âˆ’ sin q3 qÌ‡2 ) (qÌ‡1 + qÌ‡3 ) .
2
2

T3 =

Thus, being

T =

3
X
i=1

ï£«

Ti =

1 T
qÌ‡ M (q)qÌ‡,
2

with

m11
ï£¬
M (q) = ï£­ m12
m13

m12
m22
m23

ï£¶
m13
ï£·
m23 ï£¸ ,
m33

we can write the single elements of the symmetric inertia matrix M (q) as follows:
m11 = I1 + m1 d2c1 + I2 + m2 d2c2 + I3 + m3 d2c3
âˆ’ 2 m2 dc2 q2 + (m2 + m3 ) q22 + 2 m3 dc3 q2 cos q3
m12 = âˆ’m3 dc3 sin q3
m13 = I3 + m3 d2c3 + m3 dc3 q2 cos q3

(8)

m22 = m2 + m3
m23 = âˆ’m3 dc3 sin q3
m33 = I3 + m3 d2c3 .
The inertial term in the dynamic model can be rewritten in terms of p = 5 coefficients that collect
the dynamic parameters of the robot,
ï£«
ï£¶ï£«
ï£¶
a1 + 2a2 q2 + a3 q22 + 2a4 q2 cos q3 âˆ’a4 sin q3 a5 + a4 q2 cos q3
qÌˆ1
ï£¬
ï£·ï£¬
ï£·
âˆ’a4 sin q3
a3
âˆ’a4 sin q3
M (q)qÌˆ = ï£­
ï£¸ï£­ qÌˆ2 ï£¸ = Y M (q, qÌˆ)a,
a5 + a4 q2 cos q3
âˆ’a4 sin q3
a5
qÌˆ3

8

with the vector of dynamic coefficients a âˆˆ R5 defined by
a1 = I1 + m1 d2c1 + I2 + m2 d2c2 + I3 + m3 d2c3
a2 = âˆ’m2 dc2
a3 = m2 + m3

(9)

a4 = m3 dc3
a5 = I3 + m3 d2c3 .
Similarly, the entire dynamic model (because of the absence of gravity) is linearly parametrized
in terms of the same dynamic coefficients a, with a suitable n Ã— p = 3 Ã— 5 regressor matrix
Y (q, qÌ‡, qÌˆ). However, the parametrization (9) does not separate the unknown from the known
dynamic coefficients in the inertia matrix (and thus in the dynamic model). On the other hand,
the proposed adaptive law (2) does not need updating coefficients that involve only known dynamic
parameters, i.e., m3 , dc3 , and I3 .
Therefore, looking at the expressions of the elements mij in (8) and at the definitions of the
coefficients ai in (9), we can organize and separate terms in the inertia matrix as

m11 = I1 + m1 d2c1 + I2 + m2 d2c2 + I3 + m3 d2c3 âˆ’ 2 m2 dc2 q2 + (m2 + m3 ) q22 + 2 m3 dc3 q2 cos q3
= aU 1 + aK1 + 2 aU 2 q2 + (aU 3 + aK2 ) q22 + 2 aK3 q2 cos q3
m12 = âˆ’m3 dc3 sin q3 = âˆ’aK3 sin q3
m13 = I3 + m3 d2c3 + m3 dc3 q2 cos q3 = aK1 + aK3 q2 cos q3
m22 = m2 + m3 = aU 3 + aK2
m23 = âˆ’m3 dc3 sin q3 = âˆ’aK3 sin q3
m33 = I3 + m3 d2c3 = aK1 ,
with pu = 3 unknown dynamic coefficients
aU 1 = I1 + m1 d2c1 + I2 + m2 d2c2
aU 2 = âˆ’m2 dc2

(10)

aU 3 = m2 ,
organized as components of a vector aU âˆˆ R3 , and, respectively, pk = 3 known dynamic coefficients
aK1 = I3 + m3 d2c3
aK2 = m3

(11)

aK3 = m3 dc3 ,
organized as components of a vector aK âˆˆ R3 . Despite the total number of dynamic coefficients is
now higher than before (pu + pk = 6 > 5 = p), the number of those to be updated in the adaptive
law is actually lower (pu = 3).
To complete the dynamic modeling, we have to derive also the Coriolis and centrifugal terms. This
will be done by referring directly to the double parametrization by aU and aK , in view of their

9

final use in the adaptive control law (2). Rewrite the robot


M (q) = m1 (q) m2 (q) m3 (q) =
ï£«
aU 1 + aK1 + 2 aU 2 q2 + (aU 3 + aK2 ) q22 + 2 aK3 q2 cos q3
ï£¬
âˆ’aK3 sin q3
ï£­
aK1 + aK3 q2 cos q3

inertia matrix as

ï£¶
aK1 + aK3 q2 cos q3
ï£·
âˆ’aK3 sin q3
ï£¸.
aK1
(12)
Using the Christoffelâ€™s symbols for computing the components ci (q, qÌ‡) of the Coriolis and centrifugal vector c(q, qÌ‡),
!

T
âˆ‚M (q)
1 âˆ‚mi (q)
âˆ‚mi (q)
âˆ’
,
ci (q, qÌ‡) = qÌ‡ T C i (q)qÌ‡,
i = 1, 2, 3,
C i (q) =
+
2
âˆ‚q
âˆ‚q
âˆ‚qi
âˆ’aK3 sin q3
aU 3 + aK2
âˆ’aK3 sin q3

we obtain
ï£«ï£«
0
1 ï£¬ï£¬
C 1 (q) = ï£­ï£­ 0
2
0

2 aU 2 + 2 (aU 3 + aK2 ) q2 + 2 aK3 cos q3
0
aK3 cos q3

ï£«

0

aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3
0
0

= ï£­ aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3
âˆ’aK3 q2 sin q3

â‡’

ï£¶
âˆ’2 aK3 q2 sin q3
ï£·
âˆ’aK3 cos q3 ï£¸ +
âˆ’aK3 q2 sin q3

...

ï£·
âˆ’ Oï£¸

ï£¶

âˆ’aK3 q2 sin q3
ï£¸
0
âˆ’aK3 q2 sin q3

c1 (q, qÌ‡) = 2 (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡1 qÌ‡2 âˆ’ aK3 q2 sin q3 (2 qÌ‡1 + qÌ‡3 ) qÌ‡3 ,
ï£«ï£«

0
1
C 2 (q) = ï£­ï£­ 0
2
0

0
0
0

ï£¶

âˆ’aK3 cos q3
ï£¸+
0
âˆ’aK3 cos q3

!T
...

ï£«

2 aU 2 + 2 (aU 3 + aK2 ) q2 + 2 aK3 cos q3
0
âˆ’ï£­
aK3 cos q3

ï£«

âˆ’ (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 )
0
= ï£­
âˆ’aK3 cos q3

0
0
0

0
0
0

ï£¶ï£¶

aK3 cos q3
ï£¸ï£¸
0
0

ï£¶

âˆ’aK3 cos q3
ï£¸
0
âˆ’aK3 cos q3

c2 (q, qÌ‡) = âˆ’ (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡12 âˆ’ aK3 cos q3 (2 qÌ‡1 + qÌ‡3 ) qÌ‡3 ,

â‡’

ï£«ï£«
0 aK3 cos q3
1 ï£­ï£­
0
0
C 3 (q) =
2
0

0

ï£¶

âˆ’aK3 q2 sin q3
âˆ’aK3 cos q3 ï£¸ +
0

!T
...
ï£«

âˆ’2aK3 q2 sin q3
âˆ’ ï£­ âˆ’aK3 cos q3
âˆ’aK3 q2 sin q3

ï£«

aK3 q2 sin q3
= ï£­ aK3 cos q3
0

â‡’

ï£¶

!T

aK3 cos q3
0
0

ï£¶

0
0ï£¸
0

c3 (q, qÌ‡) = aK3 q2 sin q3 qÌ‡12 + 2 aK3 cos q3 qÌ‡1 qÌ‡2 ,

10

âˆ’aK3 cos q3
0
âˆ’aK3 cos q3

ï£¶ï£¶

âˆ’aK3 q2 sin q3
âˆ’aK3 cos q3 ï£¸ï£¸
0

yielding
ï£«
ï£¬
c(q, qÌ‡) = ï£¬
ï£­

2 (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡1 qÌ‡2 âˆ’ aK3 q2 sin q3 (2 qÌ‡1 + qÌ‡3 ) qÌ‡3
âˆ’ (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡12 âˆ’ aK3 cos q3 (2 qÌ‡1 + qÌ‡3 ) qÌ‡3
aK3 q2 sin q3 qÌ‡12 + 2 aK3 cos q3 qÌ‡1 qÌ‡2

ï£¶
ï£·
ï£· = S(q, qÌ‡) qÌ‡,
ï£¸

with the factorizing matrix

S(q, qÌ‡) = col qÌ‡ T C i (q, qÌ‡) =
ï£«

(13)

(aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡2
âˆ’aK3 q2 sin q3 qÌ‡3

ï£¬
ï£¬
ï£¬
ï£¬ âˆ’ (aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡1
ï£¬
âˆ’aK3 cos q3 qÌ‡3
ï£­

ï£¶
(aU 2 + (aU 3 + aK2 ) q2 + aK3 cos q3 ) qÌ‡1 âˆ’aK3 q2 sin q3 (qÌ‡1 + qÌ‡3 )ï£·

ï£·
ï£·
ï£·
âˆ’aK3 cos q3 (qÌ‡1 + qÌ‡3 ) ï£·
ï£¸

0

aK3 q2 sin q3 qÌ‡1 + aK3 cos q3 qÌ‡2

aK3 cos q3 qÌ‡1

0

being such that MÌ‡ âˆ’ 2S is skew-symmetric (check this!).
As a result, the complete dynamic model can be linearly parametrized as
M (q)qÌˆ + S(q, qÌ‡)qÌ‡ = Y U (q, qÌ‡, qÌˆ) aU + Y K (q, qÌ‡, qÌˆ) aK

(14)

with the n Ã— pu = 3 Ã— 3 regressor matrix Y U for the unknown coefficients (conveniently separating
the contributions by the inertial and by the velocity terms)
Y U (q, qÌ‡, qÌˆ) = Y U,M (q, qÌˆ) + Y U,c (q, qÌ‡)
ï£«
ï£¶ ï£«
qÌˆ1 2 q2 qÌˆ1 q22 qÌˆ1
0 2 qÌ‡1 qÌ‡2
ï£¬
ï£· ï£¬
0
qÌˆ2 ï£¸ + ï£­ 0 âˆ’qÌ‡12
=ï£­0
0
0
0
0
0

q2 qÌ‡1 qÌ‡2

ï£¶

ï£·
âˆ’q2 qÌ‡12 ï£¸

(15)

0

and, similarly, with the n Ã— pk = 3 Ã— 3 regressor matrix Y K for the known coefficients
Y K (q, qÌ‡, qÌˆ) = Y K,M (q, qÌˆ) + Y K,c (q, qÌ‡)
ï£«
ï£¶
qÌˆ1 + qÌˆ3 q22 qÌˆ1 q2 cos q3 (2 qÌˆ1 + qÌˆ3 ) âˆ’ sin q3 qÌˆ2
ï£¬
ï£·
qÌˆ2
âˆ’ sin q3 (qÌˆ1 + qÌˆ3 )
=ï£­ 0
ï£¸
qÌˆ1 + qÌˆ3
0
q2 cos q3 qÌˆ1 âˆ’ sin q3 qÌˆ2
ï£«
ï£¶
0 2 q2 qÌ‡1 qÌ‡2 2 cos q3 qÌ‡1 qÌ‡2 âˆ’ q2 sin q3 (2 qÌ‡1 + qÌ‡3 ) qÌ‡3
ï£¬
ï£·
2
+ ï£­ 0 âˆ’q2 qÌ‡12
âˆ’ cos q3 (qÌ‡1 + qÌ‡3 )
ï£¸.
2
0
0
q2 sin q3 qÌ‡1 + 2 cos q3 qÌ‡1 qÌ‡2

(16)

To complete the design of the (partly) adaptive control law (2), we need to evaluate the two above
regressors using suitable arguments. In particular, for the regressor Y U we have
Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) = Y U,M (q, qÌˆ r ) + Y U,c (q, qÌ‡, qÌ‡ r ) .

(17)

Inside the second (velocity-dependent) addend, we have to split the quadratic velocity terms by
exploiting the factorization given by matrix S in (13). For this, let
M (q) = M U (q) + M K (q)
11

be a decomposition of the inertia matrix in elements that depends (linearly) only on aU and,
respectively, only on aK . Accordingly, one can decompose also
S(q, qÌ‡) = S U (q, qÌ‡) + S K (q, qÌ‡).
It can be easily shown that the three matrices
MÌ‡ âˆ’ 2S,

MÌ‡ U âˆ’ 2S U ,

MÌ‡ K âˆ’ 2S K ,

satisfy all the skew-symmetry property (as requested by the adaptive control law â€”see below). In
particular, for this robot we have
ï£«
ï£¶
aU 1 + 2 aU 2 q2 + aU 3 q22
0
0
ï£¬
ï£·
0
aU 3 0 ï£¸
M U (q) = ï£­
0
0
0
and

ï£«

(aU 2 + aU 3 q2 ) qÌ‡2
ï£¬
S U (q, qÌ‡) = ï£­ âˆ’ (aU 2 + aU 3 q2 ) qÌ‡1
0

(aU 2 + aU 3 q2 ) qÌ‡1
0
0

ï£¶
0
ï£·
0 ï£¸.
0

It is easy to verify the skew-symmetry of MÌ‡ U âˆ’ 2S U . As a result, the second term Y U,c in (17) is
obtained by using the identity
ï£¶
ï£¶ï£«
ï£«
aU 1
0 qÌ‡1 qÌ‡2r + qÌ‡2 qÌ‡1r q2 (qÌ‡1 qÌ‡2r + qÌ‡2 qÌ‡1r )
ï£·
ï£·ï£¬
ï£¬
âˆ’qÌ‡1 qÌ‡1r
âˆ’q2 qÌ‡1 qÌ‡1r
(18)
S U (q, qÌ‡) qÌ‡ r = Y U,c (q, qÌ‡, qÌ‡ r ) aU = ï£­ 0
ï£¸ ï£­ aU 2 ï£¸ .
aU 3
0
0
0
Summarizing, the regressor matrix Y U needed in control (2), together with its transpose for the
adaptation law, is computed by (17) using Y U,M (q, qÌˆ r ) from (15) and Y U,c (q, qÌ‡, qÌ‡ r ) from (18):
ï£«
ï£¶
qÌˆ1r 2 q2 qÌˆ1r + qÌ‡1 qÌ‡2r + qÌ‡2 qÌ‡1r q22 qÌˆ2r + q2 (qÌ‡1 qÌ‡2r + qÌ‡2 qÌ‡1r )
ï£¬
ï£·
âˆ’qÌ‡1 qÌ‡1r
qÌˆ2r âˆ’ q2 qÌ‡1 qÌ‡1r
Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) = ï£­ 0
ï£¸.
0
0
0
The same considerations can be repeated for M K , S K , and Y K,c , leading to Y K (q, qÌ‡, qÌ‡ r , qÌˆ r )
(these computations are left to the reader).
The modified adaptive control law (2) provides (global) asymptotic stability of the trajectory
tracking error. The proof follows the same argument as in the complete adaptive case (simpler in
the absence of friction terms), once the above partitioned notation for unknown and known terms
has been introduced. Consider in fact the same positive definite Lyapunov candidate
V =

1 T
1
s M (q)s + eT K P e + aÌƒTU Î“âˆ’1 aÌƒ U â‰¥ 0,
2
2

(19)

where e = q d âˆ’ q, s = qÌ‡ r âˆ’ qÌ‡ = eÌ‡ + Î›e, Î› = K âˆ’1
D K P > 0, aÌƒ U = a U âˆ’ aÌ‚ U , and the gain matrices
K P > 0, K D > 0 and Î“ > 0 have been chosen as diagonal. Note that only the unknown dynamic
coefficients, those that need to be updated online, and their estimates appear in the Lyapunov
candidate. The time derivative of (19) is
VÌ‡ =

1 T
Ë™U
s MÌ‡ (q)s + sT M (q)sÌ‡ + 2 eT K P eÌ‡ âˆ’ aÌƒTU Î“âˆ’1 aÌ‚
2
12

(20)

The closed-loop dynamics, i.e., eq. (14) with the control (2), is
M (q)qÌˆ + S(q, qÌ‡)qÌ‡ = Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) aÌ‚ U + Y K (q, qÌ‡, qÌ‡ r , qÌˆ r ) aK + K P e + K D eÌ‡
= MÌ‚ U (q)qÌˆ r + SÌ‚ U (q, qÌ‡)qÌ‡ r + M K (q)qÌˆ r + S K (q, qÌ‡)qÌ‡ r + K P e + K D eÌ‡.

(21)

Subtracting both sides of eq. (21) from the identity
M (q)qÌˆ r + S(q, qÌ‡)qÌ‡ r = Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) a U + Y K (q, qÌ‡, qÌ‡ r , qÌˆ r ) aK
yields
M (q)sÌ‡ + S(q, qÌ‡)s = Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) (a U âˆ’ aÌ‚ U ) âˆ’ K P e âˆ’ K D eÌ‡
= Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) aÌƒ U âˆ’ (K P e + K D eÌ‡)

(22)

where the known term Y K aK has been cancelled. Substituting M (q)sÌ‡ from (22) into (20) and
Ë™ U = Î“ Y T (q, qÌ‡, qÌ‡ , qÌˆ ) s gives
using the update law aÌ‚
r
r
U

1 T
s MÌ‡ (q) âˆ’ 2 S(q, qÌ‡) s + sT Y U (q, qÌ‡, qÌ‡ r , qÌˆ r ) aÌƒ U âˆ’ sT (K P e + K D eÌ‡)
2
+ 2 eT K P eÌ‡ âˆ’ aÌƒTU Î“âˆ’1 Â· Î“ Y UT (q, qÌ‡, qÌ‡ r , qÌˆ r ) s
T
= âˆ’ eÌ‡ + K âˆ’1
(K P e + K D eÌ‡) + 2 eT K P eÌ‡
D KP e

VÌ‡ =

= âˆ’eÌ‡T K D eÌ‡ âˆ’ eT K P K âˆ’1
D K P e â‰¤ 0,
where we used the skew-symmetry of MÌ‡ âˆ’ 2 S and the diagonality of the gain matrices. The proof
is completed by Barbalat lemma and LaSalle theorem.
âˆ—âˆ—âˆ—âˆ—âˆ—

13

